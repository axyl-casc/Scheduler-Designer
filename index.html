<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CPU Scheduling Simulator</title>

  <!-- Tailwind CSS -->
  <link href="./styles/tailwind.min.css" rel="stylesheet">

  <!-- for styling the CPU graph diagram -->
  <link href="./styles/stylesheet.css" rel="stylesheet">

  <!-- Favicon (optional) 
    <link rel="icon" href="./assets/favicon.ico" type="image/x-icon" />
    -->
    <script src="./js/plotly-2.35.2.min.js"></script>
    <script src="./js/results.js"></script>
    <script src="./js/utils.js"></script>
    <script src="./js/process.js"></script>
    <script src="./js/simulation.js"></script>
    <script src="./js/main.js"></script>
    <script src="./js/listeners.js"></script>
</head>

<body class="bg-gray-500">
  <header class="w-full p-5 bg-gray-800 shadow-lg text-center sticky top-0 z-50">
    <h1 class="text-4xl font-bold text-white">CPU Scheduler Simulator</h1>
    <p class="text-lg mt-2 text-gray-400"></p>
  </header>
  
  <div class="flex gap-4 m-2 p-4 border border-black-300 rounded-lg bg-gray-300 shadow-md items-center">
    <a href="#" 
       onclick="document.querySelector('#aboutDialog').showModal()" 
       class="px-4 py-2 border border-gray-300 rounded-md bg-transparent text-gray-700 hover:bg-gray-200 hover:text-gray-900 transition">
      About this project
    </a>
    <a href="#" 
       onclick="document.querySelector('#algDialog').showModal()" 
       class="px-4 py-2 border border-gray-300 rounded-md bg-transparent text-gray-700 hover:bg-gray-200 hover:text-gray-900 transition">
      CPU Scheduling Algorithms
    </a>
  </div>
  <!-- Toast Container -->
  <div id="toast-container" class="fixed top-20 right-5 hidden z-60">
    <div id="toast"
      class="bg-green-600 text-white px-4 py-2 rounded shadow-md opacity-0 transition-opacity duration-500">
    </div>
  </div>
  <!-- Dialog -->
  <dialog id="aboutDialog" class="bg-white rounded-lg shadow-lg w-96 p-0">

    <!-- Modal Header -->
    <div class="px-4 py-2 bg-blue-600 text-white flex justify-between items-center rounded-t-lg">
      <h2 class="text-lg font-semibold">About Us</h2>
      <button id="closeDialog" class="text-white hover:text-gray-300"
        onclick="document.querySelector('#aboutDialog').close()">&times;</button>
    </div>

    <!-- Modal Content -->
    <div class="p-4">
      <p class="text-gray-700">
        This is the final project by Axyl and Kevin for COMP 3659. We hope you enjoy exploring what we've built and
        appreciate the effort that went into this work.
      </p>
    </div>
    <!-- Modal Footer -->
    <div class="px-4 py-2 bg-gray-100 flex justify-end rounded-b-lg">
      <button id="closeDialogFooter" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
        onclick="document.querySelector('#aboutDialog').close()">
        Close
      </button>
    </div>
  </dialog>

  <!-- Dialog -->
  <dialog id="algDialog" class="bg-white rounded-lg shadow-lg w-96 p-0">

    <!-- Modal Header -->
    <div class="px-4 py-2 bg-blue-600 text-white flex justify-between items-center rounded-t-lg">
      <h2 class="text-lg font-semibold">About Us</h2>
      <button id="closeDialog" class="text-white hover:text-gray-300"
        onclick="document.querySelector('#algDialog').close()">&times;</button>
    </div>

    <!-- Modal Content -->
    <div class="p-4">
      <span>FCFS</span><span>SJF</span><span>LJF</span>
      <p class="text-gray-700">
        info on scheduling algorithms
      </p>
    </div>
    <!-- Modal Footer -->
    <div class="px-4 py-2 bg-gray-100 flex justify-end rounded-b-lg">
      <button id="closeDialogFooter" class="px-4 py-2 bg-red-600 text-white rounded hover:bg-red-700"
        onclick="document.querySelector('#algDialog').close()">
        Close
      </button>
    </div>
  </dialog>

  <main id="mainScreen">
    <div class="flex rounded">
      <!-- Left Container: Scrollable Process List -->
      <div class="rounded m-2 w-1/4 h-full bg-gray-300 border-r overflow-y-auto">
        <div class="rounded-lg shadow-md bg-blue-300 p-4 m-4">
          <h2 class="text-xl font-bold p-4 border-b">Process List</h2>
          <ul id="processList" class="p-4 space-y-2">
            <!-- Add list items here -->
          </ul>
          <button id="editProcessBtn"
            class="ml-4 bg-green-500 text-white px-6 py-3 rounded shadow hover:bg-green-600 transition">
            Edit Processes
          </button>
          <br><br><hr><br>
          <label for="scheduler" class="block text-sm font-medium text-gray-700 mb-2 p-2">Choose a Scheduler:</label>
          <select id="scheduler"
            class="w-full px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option selected disabled value="default">Select a scheduler</option>
            <option value="fifo">FIFO</option>
            <option value="sjf">SJF</option>
            <option value="ljf">LJF</option>
            <option value="priority">Priority</option>
          </select>
          <label for="presetData" class="block text-sm font-medium text-gray-700 mb-2 p-2">Choose a Process Preset: (optional)</label>

          <select id="presetData"
            class="w-full px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg shadow-sm focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500">
            <option selected disabled value="default">Select data preset</option>
            <option value="ap">Assorted processes</option>
            <option value="sp">Single Process</option>
            <option value="ljf">Descending Arrival</option>
          </select>
        </div>


        <div class="flex items-start m-4">
          <div class="w-full">
            <div class="flex flex-row items-start">
              <button id="showSimBtn"
                class="mr-2 bg-green-500 text-white px-6 py-3 rounded shadow hover:bg-green-600 transition">
                Simulation
              </button>
        
              <button id="showResultBtn"
                class="ml-2 bg-blue-500 text-white px-6 py-3 rounded shadow hover:bg-blue-600 transition">
                Results
              </button>
            </div>
          </div>
        </div>

      </div>
      


      <!-- Right Container: Buttons for Results/Simulation -->
      <div id="windowScreen" class="w-4/5 bg-gray-500 flex flex-col items-center">
        <div id="simulatorScreen" class="w-full flex flex-grow justify-center items-start gap-4 px-4">
          <!-- Diagram Section -->
          <div class="w-5/6 h-5/6 rounded-lg shadow-md bg-gray-100 p-4">
            <svg width="600" height="400">
              <!-- Arrowhead marker -->
              <defs>
                <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="10" refY="3.5" orient="auto">
                  <polygon points="0 0, 10 3.5, 0 7" fill="black"></polygon>
                </marker>
              </defs>
        
              <!-- States -->
              <!-- New -->
              <circle cx="100" cy="50" r="40" class="state"></circle>
              <text x="100" y="50" class="state-label">New</text>
              <text x="100" y="70" class="state-label" id="new_state_process"></text>
        
              <!-- Terminated -->
              <circle cx="500" cy="50" r="40" class="state"></circle>
              <text x="500" y="50" class="state-label">Terminated</text>
              <text x="500" y="70" class="state-label" id="terminated_state_process"></text>
        
              <!-- Ready -->
              <circle cx="200" cy="200" r="40" class="state"></circle>
              <text x="200" y="200" class="state-label">Ready</text>
              <text x="200" y="220" class="state-label" id="ready_state_process"></text>
        
              <!-- Running -->
              <circle cx="400" cy="200" r="40" class="state"></circle>
              <text x="400" y="200" class="state-label">Running</text>
              <text x="400" y="220" class="state-label" id="running_state_process"></text>
        
              <!-- Waiting -->
              <circle cx="300" cy="350" r="40" class="state"></circle>
              <text x="300" y="350" class="state-label">Waiting</text>
              <text x="300" y="370" class="state-label" id="wait_state_process"></text>
        
              <!-- Transitions -->
              <!-- New to Ready -->
              <line x1="140" y1="50" x2="170" y2="170" class="arrow"></line>
        
              <!-- Ready to Running -->
              <line x1="240" y1="200" x2="360" y2="200" class="arrow"></line>
        
              <!-- Running to Waiting -->
              <line x1="380" y1="240" x2="320" y2="310" class="arrow"></line>
        
              <!-- Running to Terminated -->
              <line x1="440" y1="200" x2="470" y2="80" class="arrow"></line>
        
              <!-- Waiting to Ready -->
              <line x1="280" y1="310" x2="220" y2="240" class="arrow"></line>
        
              <!-- Running to Ready -->
              <line x1="360" y1="200" x2="240" y2="200" class="arrow"></line>
            </svg>
            <div id ="simControls" class="flex flex-grow flex-col items-center mt-8">
              <div class="flex space-x-4">
                <!-- Play Button -->
                <button id="playButton" class="px-4 py-2 bg-green-500 text-white rounded-md shadow hover:bg-green-600 focus:outline-none focus:ring-2 focus:ring-green-400">
                  Play
                </button> 

                <!-- Pause Button -->
                <button id="pauseButton" class="px-4 py-2 bg-yellow-500 text-white rounded-md shadow hover:bg-yellow-600 focus:outline-none focus:ring-2 focus:ring-yellow-400">
                  Pause
                </button>
                
                <!-- Step Button -->
                <button id="stepButton" class="px-4 py-2 bg-blue-500 text-white rounded-md shadow hover:bg-blue-600 focus:outline-none focus:ring-2 focus:ring-blue-400">
                  Step
                </button>

                <!-- Reset Button -->
              <button id="resetButton" class="px-4 py-2 bg-red-500 text-white rounded-md shadow hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-400">
                Reset
              </button>

              </div>
              
              <label for="slider" class="mb-2 text-gray-700 font-medium p-2">Adjust Speed</label>
              <input 
                id="slider" 
                type="range" 
                min="0" 
                max="2.5" 
                step="0.01" 
                value="1" 
                class="w-64 accent-blue-500"
              />
            </div>
          </div>
          
        
          <!-- Notifications Section -->
          <div id="notification-box" class="w-1/3 bg-gray-800 text-white p-4 rounded-md shadow-md h-4/6 overflow-y-auto">
            <!-- Notifications will be appended here -->
          </div>
        </div>
        

        <div id="resultScreen" class="hidden w-full h-5/6 flex flex-grow flex-col justify-center items-center py-4">
          <div class="w-5/6 h-5/6 rounded-lg shadow-md bg-gray-100 p-4 overflow-y-auto flex-grow">
            Results
            <div id="ganttChart"></div>
            <div id="boxPlot"></div>
            <div id="boxPlot2"></div>
          </div>
        </div>
      </div>
    </div>
  </main>



  <aside id="pcbScreen" class="hidden flex h-screen">
    <!-- Left Container: Scrollable Process List -->
    <div class="w-1/4 h-full bg-gray-300 border-r overflow-y-auto">
      <div class="rounded-lg shadow-md bg-blue-300 p-4 m-4">
        <h2 class="text-xl font-bold p-4 border-b">Process List</h2>
        <ul id="editProcessList" class="p-4 space-y-2">
          <!-- Add list items here -->
        </ul>
        <button id="returnMainBtn"
          class="ml-4 bg-green-500 text-white px-6 py-3 rounded shadow hover:bg-green-600 transition">
          Back to Simulator
        </button>

        <button id="clearProcessBtn" type="button"
              class="ml-6 bg-blue-500 text-white px-6 py-2 rounded-lg shadow hover:bg-blue-600 transition">
              Clear
        </button>
      </div>
    </div>


    </div>


    <!-- Right Container: PCB Editing Form -->
    <div class="w-3/4 h-full bg-gray-500 flex items-center justify-center">
      <div class="w-full max-w-2xl bg-white rounded-lg shadow-lg p-8">
        <h2 class="text-2xl font-bold mb-6 text-gray-700">Create a New Process</h2>
        <form class="space-y-6">
          <!-- Process Name? -->
          <div>
            <label for="processName" class="block text-sm font-medium text-gray-600">Process Name</label>
            <input type="text" id="processName" placeholder="Enter Process Name"
              class="w-full mt-2 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none" />
          </div>

          <!-- Priority Input? -->
          <div class="grid grid-cols-2 gap-6">
            <div>
              <label for="priorityInput" class="block text-sm font-medium text-gray-600">Priority (the lower the number the higher the priority)</label>
              <input type="number" id="priorityInput" placeholder="0"
                class="w-full mt-2 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none" />
            </div>
            <!-- Running Chance? -->
            <div>
              <label for="runningChanceInput" class="block text-sm font-medium text-gray-600">Running Chance (0-100%)</label>
              <input type="number" id="runningChanceInput" placeholder="E.g. 50 = 50%"
                class="w-full mt-2 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none" />
            </div>
          </div>

          <!-- Is I/O? -->
          <div>
            <label for="isIOInput" class="block text-sm font-medium text-gray-600">Is I/O?</label>
            <select id="isIOInput"
              class="w-full mt-2 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none">
              <option value="" disabled selected>Select True or False</option>
              <option value="true">True</option>
              <option value="false">False</option>
            </select>
          </div>

          <!-- Burst Time? -->
          <div>
            <label for="burstTimeInput" class="block text-sm font-medium text-gray-600">Burst Time</label>
            <input type="number" id="burstTimeInput" placeholder="Enter Burst Length (Should be > 0)"
              class="w-full mt-2 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none" />
          </div>

          <!-- Time to arrival? -->
          <div>
            <label for="arrivalTimeInput" class="block text-sm font-medium text-gray-600">Time to arrival</label>
            <input type="number" id="arrivalTimeInput" placeholder="Enter time to arrival (Should be >= 0)"
              class="w-full mt-2 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none" />
          </div>

          <!-- Notes Could add a process description here, would have to add to the process data structure--> 
          <div>
            <label for="notes" class="block text-sm font-medium text-gray-600">Additional Notes</label>
            <textarea id="notes" placeholder="Enter any additional notes..." rows="4"
              class="w-full mt-2 px-4 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:outline-none"></textarea>
          </div>

          <!-- Submit Button -->
          <div class="flex justify-end">
            <button id="createProcessBtn" type="button"
              class="bg-blue-500 text-white px-6 py-2 rounded-lg shadow hover:bg-blue-600 transition">
              Create
            </button>
            <button id="updateProcessBtn" type="button"
              class="hidden bg-blue-500 text-white px-6 py-2 rounded-lg shadow hover:bg-blue-600 transition">
              Update
            </button>
          </div>
        </form>
      </div>
    </div>
  </aside>

  </aside>
  <!-- Popup modal -->
  <div id="processPopup" class="fixed inset-0 hidden bg-gray-800 bg-opacity-50 flex items-center justify-center">
    <div class="bg-white p-6 rounded-lg shadow-md max-w-md">
      <h2 class="text-xl font-bold mb-4">Process Details</h2>
      <div id="processDetails" class="text-gray-800"></div>
      <button id="closePopup" class="mt-4 px-4 py-2 bg-red-500 text-white rounded">Close</button>
    </div>
  </div>



  <footer class="p-5 bg-gray-800 text-center">
    <p class="p-2 text-gray-500">
      <a href="https://axyl-casc.github.io/" class="underline">Axyl</a> & <a href="https://github.com/Kevinmru737" class="underline">Kevin</a> - COMP3659 Fall 2024. All rights reserved.
    </p>
    <p class="text-gray-500">
      Powered by <a href="https://tailwindcss.com/" class="text-blue-400 underline">Tailwind CSS</a> & <a href="https://plotly.com/" class="text-blue-400 underline">Plotly</a>
    </p>
  </footer>
  

</body>

</html>
